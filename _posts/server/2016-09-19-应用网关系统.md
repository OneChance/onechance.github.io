---
layout: post
comments: true
categories: server
---

## 关键字
统一入口、高并发、大流量、限流、防刷、实时监控

## 名词解释

#### QPS 

###### 每秒查询率是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准

#### YGC

###### 对新生代堆进行GC。频率比较高，因为大部分对象的存活寿命较短，在新生代里被回收。性能耗费较小。

#### FGC

###### 全堆范围的GC。默认堆空间使用到达80%(可调整)的时候会触发FGC。以我们生产环境为例，一般比较少会触发FGC，有时10天或一周左右会有一次。

#### time-wait

###### 通信双方建立TCP连接后，主动关闭连接的一方就会进入TIME_WAIT状态。
客户端主动关闭连接时，会发送最后一个ack后，然后会进入TIME_WAIT状态，再停留2个MSL时间(后有MSL的解释)，进入CLOSED状态

#### ACL

###### 访问控制列表，主要作用是过滤掉外面没有授权的IP地址来访问内部的资源从而做到让内部主机或服务器更安全

## 工具

###### web压测工具gatling

###### HeapAnalyzer 分析内存泄漏

## 要点

#### 并发问题

###### Nginx做负载均衡、NIO使用IO多路复用解决空闲网络连接过多引发的线程膨胀问题，Servlet 3.0的异步特性释放了入口的吞吐能力

#### 内存管理

###### CMS、G1

#### 网络优化

###### 短连接改用长连接，避免过多time-wait

###### 服务器限制time-wait状态的上限

#### 服务部署

###### 多机集群部署

###### 完善的系统监控

###### 应用配置健康检查，当一台机器服务宕机，应该自动被下线

###### 容量不够时，运维会快速扩容，或者应用手动启动服务降级

###### Nginx把请求均匀地分发给后端服务器

#### 对外部的依赖系统设置合理超时时间

#### 充分利用缓存技术 

###### 本地缓存+redis

#### 网关核心逻辑采用类责任链模式（Filter Chain）

###### 方便扩展，可插拔

#### 安全性

###### 完善的限流防刷机制

###### 可以通过ACL模块随时禁用或者启用某个来访者

###### 服务降级，利用限流机制，可以从不同维度对异常的服务或者接口降低访问频次

###### 鉴权，接口的访问通过签名和免签两种模式来鉴别用户身份。免签使用业界通用的OAuth2.0